import nmap
import argparse

"""Python nmap scanner with command line support"""

def nmapscan(targethost, targetport):
    nm = nmap.PortScanner()
    nm.scan(targethost, targetport)
    state = nm[targethost]['tcp'][int(targetport)]['state']
    print("[+] {} tcp/{} {}".format(targethost, targetport, state))


def main():
    parser = argparse.ArgumentParser(description="Example: python pyScan.py 127.0.0.1 22")
    parser.add_argument(action="store", help="Enter the host IP", dest="host")
    parser.add_argument(action="store", help="Enter the target port", dest="port", type=int)
    given_args = parser.parse_args()
    targethost = given_args.host
    targetport = given_args.port

    # make sure values are not null
    if (targethost == None) | (targetport == None):
        print(parser.usage)
        exit(0)
    else:
        print("Scanning {} - {}".format(targethost, targetport))
        nmapscan(targethost, str(targetport))


main()
